# 🎯 微信消息 AI 分析器 - 实际使用说明

## 📊 测试结果

### ✅ 成功项目
- Python 环境: ✅ Python 3.13.7
- 依赖安装: ✅ 所有包已安装
- Gemini API: ✅ 连接正常
- 文件分析: ✅ 测试成功
- 微信路径: ✅ 已配置 `D:\沟通\wx\xwechat_files`

### ⚠️ 发现的问题
- **微信版本**: 你使用的是**多开版微信**（WeChatAppEx）
- **pywxdump**: 不支持多开版，仅支持官方微信
- **自动提取**: 暂时无法自动提取

---

## 🚀 推荐方案

### 方案 1: 使用 WeChatMsg 工具 ⭐⭐⭐⭐⭐（强烈推荐）

**这是目前最好的方案！**

#### 步骤：

1. **下载 WeChatMsg**
   - 访问: https://github.com/LC044/WeChatMsg/releases
   - 下载最新版本（如 `WeChatMsg_v3.x.exe`）

2. **运行工具**
   - 双击运行
   - 自动识别微信数据（支持多开版）
   - 图形界面操作

3. **导出消息**
   - 选择时间范围（如：最近24小时）
   - 导出格式选择 **TXT** 或 **Markdown**
   - 保存到本地（如：`messages.txt`）

4. **AI 分析**
   ```powershell
   python main.py --file messages.txt
   ```

#### 优点：
- ✅ 支持多开版微信
- ✅ 图形界面，简单易用
- ✅ 自动处理加密
- ✅ 可以导出所有格式
- ✅ 一次导出，反复分析

---

### 方案 2: 手动复制聊天记录 ⭐⭐⭐⭐

**最简单直接的方法**

#### 步骤：

1. **复制微信聊天**
   - 在微信中选择聊天记录
   - Ctrl+C 复制
   - 粘贴到文本文件

2. **保存为文本**
   ```
   创建文件: my_chats.txt
   粘贴聊天记录
   保存
   ```

3. **AI 分析**
   ```powershell
   python main.py --file my_chats.txt
   ```

#### 优点：
- ✅ 完全免费
- ✅ 无需额外工具
- ✅ 随时可用

---

### 方案 3: 使用官方微信 + pywxdump ⭐⭐⭐

**如果你能切换到官方微信**

#### 前提：
- 卸载多开版
- 安装官方微信
- 重新登录

#### 使用：
```powershell
# 确保官方微信运行中
python main.py --hours 24
```

#### 缺点：
- ❌ 需要卸载多开版
- ❌ 不能同时登录多个账号

---

## 💡 我的建议

### 最佳实践

**日常使用推荐流程：**

1. **每天晚上**
   - 打开 WeChatMsg 工具
   - 导出当天聊天记录
   - 保存为 `daily_YYYYMMDD.txt`

2. **运行分析**
   ```powershell
   cd wechat-ai-analyzer
   python main.py --file daily_20251105.txt
   ```

3. **查看报告**
   - 打开 `reports/report_*.md`
   - 查看 AI 分析结果

---

## 📝 快速操作指南

### 现在就可以用！

我已经创建了测试文件，你可以立即体验：

```powershell
# 进入目录
cd wechat-ai-analyzer

# 分析测试数据
python main.py --file test_messages.txt

# 查看报告
notepad reports\report_from_file_*.md
```

### 分析真实消息

**方法1: 使用 WeChatMsg（推荐）**
```powershell
# 1. 用 WeChatMsg 导出消息
# 2. 运行分析
python main.py --file 导出的文件.txt
```

**方法2: 手动复制**
```powershell
# 1. 从微信复制聊天记录到 my_chat.txt
# 2. 运行分析
python main.py --file my_chat.txt
```

---

## 🎯 实际使用场景

### 场景 1: 每日工作总结

```powershell
# 每天下班前
# 1. 导出工作群聊天记录
# 2. 分析
python main.py --file work_today.txt
# 3. 查看待办事项和重要信息
```

### 场景 2: 客户沟通分析

```powershell
# 定期分析客户对话
python main.py --file customer_chats.txt
# 了解客户需求和问题
```

### 场景 3: 团队协作优化

```powershell
# 每周分析团队沟通
python main.py --file team_week.txt
# 发现协作问题
```

---

## ⚙️ 配置文件

当前配置 (`config.json`):

```json
{
  "gemini_api_key": "AIzaSyApuy_ax9jhGXpUdlgI6w_0H5aZ7XiY9vU",
  "analyze_last_hours": 24,
  "output_dir": "./reports",
  "wechat_data_path": "D:\\沟通\\wx\\xwechat_files"
}
```

**说明**:
- ✅ API Key 已配置
- ✅ 微信路径已设置（虽然暂时用不到）
- ✅ 报告保存在 `reports` 目录

---

## 🛠️ 常用命令

```powershell
# 测试 API 连接
python main.py --test

# 从文件分析（推荐）
python main.py --file your_messages.txt

# 查看帮助
python main.py --help

# 查看报告
Get-ChildItem reports
```

---

## 📚 相关工具

### WeChatMsg (推荐)
- 项目地址: https://github.com/LC044/WeChatMsg
- 功能: 导出、分析、备份微信聊天
- 支持: 多开版微信
- 免费开源

### 其他工具
- WeChatExporter (Mac)
- PyWxDump (官方微信)

---

## ❓ 常见问题

### Q: 为什么不能自动提取？
A: 你使用的是多开版微信，pywxdump 暂不支持。建议使用 WeChatMsg 工具。

### Q: 数据安全吗？
A: 
- ✅ 所有处理都在本地
- ✅ 只有分析文本会发送给 Gemini API
- ✅ 原始数据库文件不会上传

### Q: API 有使用限制吗？
A: Gemini API 有免费额度，一般个人使用足够。如超出可以：
- 更换 API Key
- 使用其他 AI 服务

### Q: 能分析语音和图片吗？
A: 当前版本只支持文本。需要先用其他工具转换。

---

## 🎉 开始使用

### 立即体验（1分钟）

```powershell
# 1. 进入目录
cd wechat-ai-analyzer

# 2. 运行测试
python main.py --file test_messages.txt

# 3. 查看报告
notepad reports\report_from_file_*.md
```

### 实际使用（5分钟）

```powershell
# 1. 下载 WeChatMsg: https://github.com/LC044/WeChatMsg/releases
# 2. 导出今天的聊天记录为 today.txt
# 3. 运行分析
python main.py --file today.txt
# 4. 查看生成的报告
```

---

## 📞 需要帮助？

- 查看 README.md 了解更多功能
- 查看 test_messages.txt 了解消息格式
- 查看 reports/ 目录查看示例报告

---

**祝使用愉快！🎊**

如有问题随时反馈。

