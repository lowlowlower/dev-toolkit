# 📦 微信消息 AI 分析器 - 详细安装指南

## 系统要求

- ✅ Windows 10/11
- ✅ Python 3.8 或更高版本
- ✅ 微信 PC 客户端
- ✅ 互联网连接（用于调用 Gemini API）

## 安装步骤

### 步骤 1: 安装 Python

#### 检查是否已安装

打开 PowerShell，运行：
```powershell
python --version
```

如果显示版本号（如 `Python 3.11.0`），则已安装，跳到步骤 2。

#### 安装 Python

1. 访问 [Python 官网](https://www.python.org/downloads/)
2. 下载最新版本（3.8+）
3. 运行安装程序
4. ⚠️ **重要**：勾选 "Add Python to PATH"
5. 点击 "Install Now"

安装完成后，重新打开 PowerShell 验证：
```powershell
python --version
pip --version
```

### 步骤 2: 下载项目

#### 方法一：直接下载
1. 下载项目文件到本地
2. 解压到你想要的位置，如 `D:\wechat-ai-analyzer`

#### 方法二：使用 Git（如果已安装）
```powershell
git clone [项目地址]
cd wechat-ai-analyzer
```

### 步骤 3: 安装依赖

打开 PowerShell，进入项目目录：
```powershell
cd D:\wechat-ai-analyzer
```

安装 Python 依赖：
```powershell
pip install -r requirements.txt
```

如果速度慢，使用国内镜像：
```powershell
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 步骤 4: 获取 Gemini API Key

1. 访问 [Google AI Studio](https://aistudio.google.com/app/apikey)
2. 登录 Google 账号
3. 点击 "Create API Key"
4. 复制生成的 API Key

### 步骤 5: 配置项目

复制配置文件：
```powershell
copy config.example.json config.json
```

编辑 `config.json`：
```powershell
notepad config.json
```

填入你的 API Key：
```json
{
  "gemini_api_key": "粘贴你的API_KEY",
  "analyze_last_hours": 24,
  "output_dir": "./reports"
}
```

保存并关闭。

### 步骤 6: 测试安装

#### 测试 API 连接
```powershell
python main.py --test
```

如果看到 `✅ API 连接正常！`，说明配置成功。

#### 测试消息提取
```powershell
python wechat_extractor.py
```

程序会尝试自动查找微信数据路径。

## 常见安装问题

### 问题 1: "python" 不是内部或外部命令

**原因**: Python 未添加到系统 PATH

**解决**:
1. 重新安装 Python，勾选 "Add Python to PATH"
2. 或手动添加 PATH：
   - 右键"此电脑" → "属性" → "高级系统设置"
   - "环境变量" → "Path" → "新建"
   - 添加 Python 安装路径（如 `C:\Python311`）

### 问题 2: pip install 超时或失败

**解决**: 使用国内镜像
```powershell
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

或逐个安装：
```powershell
pip install requests
pip install pywxdump
pip install python-dotenv
pip install pandas
pip install schedule
```

### 问题 3: ModuleNotFoundError

**原因**: 依赖未正确安装

**解决**:
```powershell
# 重新安装
pip uninstall -y -r requirements.txt
pip install -r requirements.txt
```

### 问题 4: API 连接失败

**检查清单**:
- ✅ API Key 是否正确（无多余空格）
- ✅ 网络是否能访问 Google 服务
- ✅ 防火墙设置

**测试网络**:
```powershell
# 测试能否访问 Google API
curl "https://generativelanguage.googleapis.com"
```

### 问题 5: 找不到微信数据路径

**手动指定路径**:

1. 打开微信 → 设置 → 文件管理
2. 查看"文件管理" → 记下路径
3. 在 `config.json` 中添加：
```json
{
  "wechat_data_path": "C:\\Users\\你的用户名\\Documents\\WeChat Files"
}
```

注意：Windows 路径要用双反斜杠 `\\`

## 安装验证清单

安装完成后，逐项检查：

- [ ] Python 已安装（`python --version`）
- [ ] pip 可用（`pip --version`）
- [ ] 依赖已安装（`pip list` 查看）
- [ ] config.json 已创建并配置
- [ ] API 测试通过（`python main.py --test`）
- [ ] 可以找到微信数据路径

## 下一步

安装完成后，阅读 [README.md](README.md) 了解如何使用。

快速开始：
```powershell
# 分析最近24小时的微信消息
python main.py
```

## 需要帮助？

如遇到其他问题：
1. 检查错误信息
2. 查看 [README.md](README.md) 的常见问题部分
3. 确保所有步骤正确执行

---

**祝你使用愉快！🎉**

