# ğŸ³ Docker Supabase å‘½ä»¤è¡Œå·¥å…·

å®Œæ•´çš„ Docker Supabase å‘½ä»¤è¡Œç®¡ç†å·¥å…·é›†ã€‚

## ğŸ“‹ è„šæœ¬åˆ—è¡¨

### 1. å®‰è£…å’Œå¯åŠ¨

| è„šæœ¬ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| `install.ps1` | å®‰è£… Supabase | é¦–æ¬¡ä½¿ç”¨ï¼Œæ‹‰å–æ‰€æœ‰é•œåƒ |
| `start.ps1` | å¯åŠ¨æœåŠ¡ | æ¯æ¬¡éœ€è¦å¯åŠ¨æ•°æ®åº“ |
| `stop.ps1` | åœæ­¢æœåŠ¡ | åœæ­¢æ•°æ®åº“æœåŠ¡ |
| `status.ps1` | æŸ¥çœ‹çŠ¶æ€ | æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€ |

### 2. æ•°æ®åº“ç®¡ç†

| è„šæœ¬ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| `init-db.ps1` | åˆå§‹åŒ–æ•°æ®åº“ | é¦–æ¬¡å¯åŠ¨æˆ–é‡ç½®æ•°æ® |
| `query.ps1` | æŸ¥è¯¢æ•°æ® | æŸ¥çœ‹æ•°æ®åº“å†…å®¹ |
| `backup.ps1` | å¤‡ä»½æ•°æ® | å®šæœŸå¤‡ä»½ |
| `restore.ps1` | æ¢å¤æ•°æ® | ä»å¤‡ä»½æ¢å¤ |

### 3. æ—¥å¿—å’Œç›‘æ§

| è„šæœ¬ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| `logs.ps1` | æŸ¥çœ‹æ—¥å¿— | è°ƒè¯•å’Œç›‘æ§ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®Œæ•´æµç¨‹

```powershell
# 1. å®‰è£…ï¼ˆä»…é¦–æ¬¡éœ€è¦ï¼‰
.\docker\install.ps1

# 2. å¯åŠ¨æœåŠ¡
.\docker\start.ps1

# 3. åˆå§‹åŒ–æ•°æ®åº“
.\docker\init-db.ps1

# 4. æŸ¥çœ‹çŠ¶æ€
.\docker\status.ps1

# 5. å¯åŠ¨å‰ç«¯
npm run dev
```

## ğŸ“ è¯¦ç»†è¯´æ˜

### install.ps1 - å®‰è£…

**åŠŸèƒ½:**
- æ£€æŸ¥ Docker ç¯å¢ƒ
- æ‹‰å–æ‰€æœ‰ Supabase é•œåƒ
- åˆ›å»º Docker ç½‘ç»œ

**ä½¿ç”¨:**
```powershell
.\docker\install.ps1
```

**è¾“å‡º:**
- âœ… æ‰€æœ‰é•œåƒæ‹‰å–æˆåŠŸ
- âœ… Docker ç½‘ç»œåˆ›å»ºæˆåŠŸ

---

### start.ps1 - å¯åŠ¨

**åŠŸèƒ½:**
- å¯åŠ¨æ‰€æœ‰ Supabase æœåŠ¡
- ç­‰å¾…æ•°æ®åº“å°±ç»ª
- æ˜¾ç¤ºæœåŠ¡è®¿é—®åœ°å€

**ä½¿ç”¨:**
```powershell
.\docker\start.ps1
```

**æœåŠ¡ç«¯å£:**
- 54322: PostgreSQL æ•°æ®åº“
- 54323: Supabase Studioï¼ˆç®¡ç†ç•Œé¢ï¼‰
- 54324: Kong API ç½‘å…³
- 54325: GoTrue è®¤è¯æœåŠ¡
- 54326: PostgREST API
- 54327: Storage å­˜å‚¨æœåŠ¡

---

### init-db.ps1 - åˆå§‹åŒ–æ•°æ®åº“

**åŠŸèƒ½:**
- æ‰§è¡Œ `supabase/init.sql` è„šæœ¬
- åˆ›å»ºè¡¨ç»“æ„
- æ’å…¥åˆå§‹æ•°æ®

**ä½¿ç”¨:**
```powershell
.\docker\init-db.ps1
```

**åˆ›å»ºçš„è¡¨:**
- `business_cards` - 20å¼ äº‹ä¸šå¡ç‰‡
- `card_combinations` - å¡ç‰‡ç»„åˆ
- `workflow_templates` - 5ä¸ªå·¥ä½œæµæ¨¡æ¿
- `user_progress` - ç”¨æˆ·è¿›åº¦

---

### stop.ps1 - åœæ­¢æœåŠ¡

**åŠŸèƒ½:**
- æä¾›3ç§åœæ­¢æ–¹å¼
- å¯é€‰æ‹©æ˜¯å¦ä¿ç•™æ•°æ®

**ä½¿ç”¨:**
```powershell
.\docker\stop.ps1
```

**é€‰é¡¹:**
1. ä»…åœæ­¢å®¹å™¨ï¼ˆä¿ç•™æ•°æ®ï¼‰- æ¨èæ—¥å¸¸ä½¿ç”¨
2. åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆä¿ç•™æ•°æ®å·ï¼‰- å®Œå…¨å…³é—­
3. å®Œå…¨æ¸…ç†ï¼ˆåˆ é™¤æ‰€æœ‰æ•°æ®ï¼‰âš ï¸ - é‡æ–°å¼€å§‹

---

### status.ps1 - çŠ¶æ€æ£€æŸ¥

**åŠŸèƒ½:**
- æ£€æŸ¥æ‰€æœ‰å®¹å™¨çŠ¶æ€
- æ˜¾ç¤ºç«¯å£æ˜ å°„
- åˆ—å‡ºæ•°æ®å·

**ä½¿ç”¨:**
```powershell
.\docker\status.ps1
```

**æ˜¾ç¤ºä¿¡æ¯:**
- âœ“/âœ— å®¹å™¨è¿è¡ŒçŠ¶æ€
- ç«¯å£å·
- æ•°æ®å·
- è®¿é—®åœ°å€

---

### logs.ps1 - æŸ¥çœ‹æ—¥å¿—

**åŠŸèƒ½:**
- æŸ¥çœ‹å®æ—¶æ—¥å¿—
- æ”¯æŒå•ä¸ªæˆ–æ‰€æœ‰æœåŠ¡

**ä½¿ç”¨:**
```powershell
.\docker\logs.ps1
```

**å¯é€‰æœåŠ¡:**
1. æ‰€æœ‰æœåŠ¡
2. æ•°æ®åº“
3. APIç½‘å…³
4. ç®¡ç†ç•Œé¢
5. è®¤è¯æœåŠ¡
6. REST API
7. å­˜å‚¨æœåŠ¡

**æç¤º:** æŒ‰ Ctrl+C é€€å‡ºæ—¥å¿—æŸ¥çœ‹

---

### query.ps1 - æŸ¥è¯¢æ•°æ®

**åŠŸèƒ½:**
- å¿«é€ŸæŸ¥è¯¢æ•°æ®
- æ”¯æŒè‡ªå®šä¹‰ SQL
- äº¤äº’å¼ SQL æ¨¡å¼

**ä½¿ç”¨:**
```powershell
.\docker\query.ps1
```

**é¢„è®¾æŸ¥è¯¢:**
1. æŸ¥çœ‹æ‰€æœ‰å¡ç‰‡
2. æŸ¥çœ‹æ‰€æœ‰ç»„åˆ
3. æŸ¥çœ‹å·¥ä½œæµæ¨¡æ¿
4. å¡ç‰‡ç»Ÿè®¡
5. è‡ªå®šä¹‰ SQL
6. äº¤äº’å¼æ¨¡å¼

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: Docker æœªè¿è¡Œ
```
âŒ Docker æœªè¿è¡Œï¼Œè¯·å…ˆå¯åŠ¨ Docker Desktop
```
**è§£å†³:** æ‰“å¼€ Docker Desktop åº”ç”¨

---

### é—®é¢˜ 2: ç«¯å£è¢«å ç”¨
```
Error: bind: address already in use
```
**è§£å†³:**
```powershell
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr "54322"

# åœæ­¢è¿›ç¨‹
taskkill /PID <è¿›ç¨‹ID> /F
```

---

### é—®é¢˜ 3: å®¹å™¨å¯åŠ¨å¤±è´¥
**è§£å†³:**
```powershell
# æŸ¥çœ‹æ—¥å¿—
.\docker\logs.ps1

# å®Œå…¨æ¸…ç†åé‡æ–°å¯åŠ¨
.\docker\stop.ps1  # é€‰æ‹©é€‰é¡¹ 3
.\docker\start.ps1
```

---

### é—®é¢˜ 4: æ•°æ®åº“è¿æ¥å¤±è´¥
**æ£€æŸ¥:**
```powershell
# 1. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
.\docker\status.ps1

# 2. æµ‹è¯•æ•°æ®åº“è¿æ¥
docker exec supabase-db pg_isready -U postgres

# 3. æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
.\docker\logs.ps1  # é€‰æ‹©é€‰é¡¹ 2
```

---

## ğŸ¯ å¸¸ç”¨å‘½ä»¤ç»„åˆ

### å®Œå…¨é‡ç½®
```powershell
.\docker\stop.ps1      # é€‰æ‹© 3 - å®Œå…¨æ¸…ç†
.\docker\start.ps1     # å¯åŠ¨æœåŠ¡
.\docker\init-db.ps1   # åˆå§‹åŒ–æ•°æ®
```

### æ—¥å¸¸ä½¿ç”¨
```powershell
# å¼€å§‹å·¥ä½œ
.\docker\start.ps1

# ç»“æŸå·¥ä½œ
.\docker\stop.ps1      # é€‰æ‹© 1 - ä»…åœæ­¢
```

### è°ƒè¯•æ¨¡å¼
```powershell
# 1. æŸ¥çœ‹çŠ¶æ€
.\docker\status.ps1

# 2. æŸ¥çœ‹æ—¥å¿—
.\docker\logs.ps1

# 3. æŸ¥è¯¢æ•°æ®
.\docker\query.ps1
```

---

## ğŸ’¡ æç¤ºå’ŒæŠ€å·§

### 1. è‡ªåŠ¨å¯åŠ¨
å°†å¯åŠ¨è„šæœ¬æ·»åŠ åˆ°ç³»ç»Ÿå¯åŠ¨é¡¹:
```powershell
# åˆ›å»ºå¿«æ·æ–¹å¼åˆ°å¯åŠ¨æ–‡ä»¶å¤¹
$startup = "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup"
# å°† start.ps1 å¿«æ·æ–¹å¼æ”¾å…¥æ­¤æ–‡ä»¶å¤¹
```

### 2. åˆ«åè®¾ç½®
åœ¨ PowerShell é…ç½®æ–‡ä»¶ä¸­æ·»åŠ åˆ«å:
```powershell
# ç¼–è¾‘é…ç½®æ–‡ä»¶
notepad $PROFILE

# æ·»åŠ åˆ«å
Set-Alias sup ".\docker\start.ps1"
Set-Alias sdown ".\docker\stop.ps1"
Set-Alias sstatus ".\docker\status.ps1"
```

### 3. å®šæ—¶å¤‡ä»½
ä½¿ç”¨ Windows ä»»åŠ¡è®¡åˆ’ç¨‹åº:
```powershell
# åˆ›å»ºæ¯æ—¥å¤‡ä»½ä»»åŠ¡
$trigger = New-ScheduledTaskTrigger -Daily -At 2am
$action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-File .\docker\backup.ps1"
Register-ScheduledTask -TaskName "SupabaseBackup" -Trigger $trigger -Action $action
```

---

## ğŸ“š æ›´å¤šèµ„æº

- [Docker æ–‡æ¡£](https://docs.docker.com/)
- [Supabase æ–‡æ¡£](https://supabase.com/docs)
- [PostgreSQL æ–‡æ¡£](https://www.postgresql.org/docs/)

---

**éœ€è¦å¸®åŠ©?** è¿è¡Œ `.\docker\status.ps1` æŸ¥çœ‹æœåŠ¡çŠ¶æ€

